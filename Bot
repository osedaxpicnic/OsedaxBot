import os
import discord as dpy
from discord.ext import commands

intents = dpy.Intents.default()
intents.message_content = True
bot = commands.Bot(command_prefix="!", intents=intents)

@bot.event
async def on_ready():
    print(f"âœ… ConnectÃ© comme {bot.user} (ID: {bot.user.id})")
# --- Message d'accueil automatique ---
@bot.event
async def on_ready():
    print(f"âœ… ConnectÃ© comme {bot.user} (ID: {bot.user.id})")
    await bot.change_presence(activity=dpy.Game("ğŸ§  Osedax Assistant actif !"))

    # Cherche le salon par nom
    channel = None
    for guild in bot.guilds:
        for ch in guild.text_channels:
            if ch.name == "ğŸ¤–-osedax-bot" or ch.name == "osedax-bot":
                channel = ch
                break

    # Envoie le message si trouvÃ©
    if channel:
        await channel.send(
            "ğŸ§  **Osedax Assistant est en ligne !**\n"
            "Voici ce que je peux faire :\n"
            "â€¢ `!ping` â†’ test de connexion\n"
            "â€¢ `!aide` â†’ liste des commandes\n"
            "â€¢ (plus Ã  venir...)\n\n"
            "_Tape `!aide` pour plus dâ€™infos._"
        )
    else:
        print("âš ï¸ Salon #ğŸ¤–-osedax-bot introuvable.")

@bot.command()
async def ping(ctx):
    await ctx.send("Pong ! ğŸ“")

TOKEN = os.getenv("DISCORD_TOKEN", "").strip()
if not TOKEN:
    raise RuntimeError("DISCORD_TOKEN manquant (variable d'environnement).")

bot.run(TOKEN)
